<!DOCTYPE html>
<html>
    <body>
        <canvas id="viewport" width="726" height="544" style="border:1px solid #d3d3d3;"></canvas>
        <p id="p1">Hover your mouse over the image</p>
        <p id="p2">Now click on a couple of points</p>
        <p id="debug">debug</p>
        <button id="prevButton" onClick="changeSlide(-1);">Previous</button>
        <button id="nextButton" onClick="changeSlide(1);">Next</button>
        <script>
            var canvas = document.getElementById('viewport'),
            context = canvas.getContext('2d');

            var firstClick = false;

            var mx1, my1, mx2, my2;

            // var slides = ["page_4.png", "page_5.png", "page_4.png", "page_5.png"];
            var slides = [ SLIDESHERE ];
            var currentSlideIdx = 1;

            document.getElementById("debug").innerHTML = "Slide " + (currentSlideIdx+1) + " of " + slides.length; 
            function make_base(imgname)
            {
                base_image = new Image();
                base_image.src = imgname;
                base_image.onload = function() {
                    context.drawImage(base_image, 0, 0, 726,544);
                }
            }
            make_base(slides[currentSlideIdx]);

            function getMousePos(canvas, evt) {
                var rect = canvas.getBoundingClientRect();
                return {
                    x: evt.clientX - rect.left,
                    y: evt.clientY - rect.top
                };
            }
            
            function changeSlide(which) {
                which = parseInt(which);
                currentSlideIdx = (currentSlideIdx + which + slides.length) % slides.length;
                make_base(slides[currentSlideIdx]);
                document.getElementById("debug").innerHTML = "Slide " + (currentSlideIdx+1) + " of " + slides.length; 
            }
            canvas.addEventListener('mousemove', function(evt) {
                var mousePos = getMousePos(canvas, evt);
                document.getElementById("p1").innerHTML = "("+(mousePos.x/726).toFixed(2)+","+(mousePos.y/544).toFixed(2)+")";
            }, false);



            canvas.addEventListener('mousedown', function(evt) {
                var mousePos = getMousePos(canvas, evt);
                if(! firstClick ) {
                    make_base(slides[currentSlideIdx]);
                    firstClick = true;
                    mx1 = (mousePos.x/726).toFixed(2);
                    my1 = (mousePos.y/544).toFixed(2);


                    } else if (firstClick ) {
                    firstClick = false;

                    mx2 = (mousePos.x/726).toFixed(2);
                    my2 = (mousePos.y/544).toFixed(2);
                    document.getElementById("p2").innerHTML = "sm.arrowObject( ("+mx1+","+my1+"), ("+mx2+","+my2+") )"

                    context.beginPath();
                    context.moveTo(mx1*726, my1*544);
                    context.lineTo(mx2*726, my2*544);
                    context.stroke();

                }
            }, false);

        </script> 

    </body>
</html>


